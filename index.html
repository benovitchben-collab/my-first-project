<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>DEMO Casino ‚Äî Mini App</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
:root{
  --bg:#0b0f1a; --card:#12172a; --neon:#00ffd5; --gold:#ffb700;
  --red:#ff4d4d; --green:#00ff88; --muted:#9aa3c7;
}
*{box-sizing:border-box}
body{
  margin:0; font-family:Inter,Arial,sans-serif; color:#fff;
  background:radial-gradient(circle at top,#141a3a,var(--bg));
}
header{
  padding:14px; display:flex; justify-content:space-between; align-items:center;
  background:rgba(0,0,0,.55); box-shadow:0 0 25px rgba(0,255,213,.35);
}
h3{margin:6px 0 10px}
.balance{color:var(--neon); font-weight:800; transition:.25s}
.small{color:var(--muted); font-size:12px}
.menu{display:flex; gap:6px; padding:10px; overflow-x:auto}
.menu button{
  min-width:120px; padding:10px 12px; border-radius:12px; border:none;
  background:linear-gradient(135deg,var(--gold),#ff7b00);
  font-weight:800; cursor:pointer;
}
.game{display:none; padding:16px}
.card{
  background:var(--card); border-radius:18px; padding:16px;
  box-shadow:0 0 20px rgba(0,255,213,.18); animation:fade .35s;
}
@keyframes fade{from{opacity:.4; transform:translateY(4px)} to{opacity:1}}
.action{
  width:100%; padding:14px; margin-top:10px; border-radius:14px; border:none;
  font-size:16px; font-weight:800;
  background:linear-gradient(135deg,var(--neon),#00b3ff);
  cursor:pointer;
}
.row{display:flex; gap:8px; flex-wrap:wrap}
.chip{padding:6px 10px; border-radius:999px; background:#0a0f24}
.result{margin-top:10px; font-weight:800}
.win{color:var(--green)} .lose{color:var(--red)}
.bigwin{font-size:28px; color:var(--gold); text-shadow:0 0 18px var(--gold); animation:pulse 1s infinite}
@keyframes pulse{50%{transform:scale(1.08)}}

/* SLOTS */
.reels{display:grid; grid-template-columns:repeat(5,1fr); gap:8px; margin:14px 0}
.reel{
  height:70px; background:#0a0f24; border-radius:12px; font-size:32px;
  display:flex; align-items:center; justify-content:center;
  box-shadow:inset 0 0 15px #000; animation:spin .25s;
}
@keyframes spin{from{transform:translateY(-18px)} to{transform:none}}
.paylines{display:flex; gap:6px; justify-content:center}
.line{width:60px; height:4px; background:#1f2a5a; border-radius:6px}
.line.on{background:var(--gold); box-shadow:0 0 10px var(--gold)}

/* CRASH */
.crashVal{font-size:44px; color:var(--neon); text-shadow:0 0 22px var(--neon)}
.toggle{display:flex; align-items:center; gap:8px}

/* ROULETTE */
.wheel{font-size:64px; animation:spinSlow 1.8s ease-out}
@keyframes spinSlow{from{transform:rotate(0)} to{transform:rotate(720deg)}}
.history{display:flex; gap:6px; flex-wrap:wrap}

/* MINES */
.grid{display:grid; grid-template-columns:repeat(5,1fr); gap:8px}
.cell{
  height:60px; background:#0a0f24; border-radius:10px;
  display:flex; align-items:center; justify-content:center;
  font-size:26px; cursor:pointer;
}
.cell.open{background:#101a3a}
.cell.dead{background:#2a0f1a}

/* FOOT */
.footer{padding:10px; text-align:center; color:var(--muted)}
</style>
</head>

<body>
<header>
  <div>üé∞ DEMO Casino</div>
  <div class="balance">üí∞ <span id="balance">10000</span></div>
</header>

<div class="menu">
  <button onclick="show('slots')">üé∞ Slots</button>
  <button onclick="show('crash')">üöÄ Crash</button>
  <button onclick="show('roulette')">üé° Roulette</button>
  <button onclick="show('mines')">üí£ Mines</button>
  <button onclick="show('bonus')">üéÅ Bonus</button>
</div>

<!-- SLOTS -->
<div id="slots" class="game">
  <div class="card">
    <h3>Slots 5√ó3</h3>
    <div class="row small">
      <div class="chip">WILD üÉè</div>
      <div class="chip">SCATTER üéÅ (Free Spins)</div>
      <div class="chip">Bet: 100</div>
      <div class="chip">FS: <b id="fs">0</b></div>
    </div>
    <div class="reels" id="reels"></div>
    <div class="paylines">
      <div class="line" id="l1"></div>
      <div class="line" id="l2"></div>
      <div class="line" id="l3"></div>
    </div>
    <button class="action" onclick="spin()">SPIN</button>
    <div id="slotRes" class="result"></div>
  </div>
</div>

<!-- CRASH -->
<div id="crash" class="game">
  <div class="card">
    <h3>Crash</h3>
    <div class="crashVal" id="crashVal">1.00x</div>
    <div class="row">
      <div class="toggle">
        <input type="checkbox" id="auto" />
        <label for="auto">Auto cashout @</label>
        <input id="autoAt" type="number" value="2.00" step="0.01" style="width:80px">
      </div>
    </div>
    <button class="action" onclick="startCrash()">BET 100</button>
    <button class="action" onclick="cashout()">CASH OUT</button>
    <div id="crashRes" class="result"></div>
  </div>
</div>

<!-- ROULETTE -->
<div id="roulette" class="game">
  <div class="card">
    <h3>Roulette (EU)</h3>
    <div class="wheel">üé°</div>
    <button class="action" onclick="playRoulette()">SPIN 100</button>
    <div class="history" id="hist"></div>
    <div id="roulRes" class="result"></div>
  </div>
</div>

<!-- MINES -->
<div id="mines" class="game">
  <div class="card">
    <h3>Mines</h3>
    <div class="row">
      <label>Bombs:</label>
      <select id="bombsSel">
        <option>3</option><option selected>5</option><option>10</option>
      </select>
      <div class="chip">Coeff: <b id="coef">1.00x</b></div>
    </div>
    <div class="grid" id="grid"></div>
    <button class="action" onclick="startMines()">START 100</button>
    <button class="action" onclick="cashMines()">CASHOUT</button>
    <div id="mineRes" class="result"></div>
  </div>
</div>

<!-- BONUS -->
<div id="bonus" class="game">
  <div class="card">
    <h3>Daily Bonus</h3>
    <div class="small">–†–∞–∑ –≤ 24 —á–∞—Å–∞</div>
    <button class="action" onclick="daily()">CLAIM</button>
    <div class="row">
      <div class="chip">Level: <b id="lvl">1</b></div>
      <div class="chip">XP: <b id="xp">0</b></div>
    </div>
    <div id="bonusRes" class="result"></div>
  </div>
</div>

<div class="footer small">DEMO only ‚Ä¢ No real money</div>

<script>
const tg = Telegram.WebApp; tg.expand();

/* ===== STATE ===== */
let bet = 100;
let balance = +localStorage.getItem('bal') || 10000;
let xp = +localStorage.getItem('xp') || 0;
let lvl = +localStorage.getItem('lvl') || 1;
let freeSpins = +localStorage.getItem('fs') || 0;

/* ===== UI ===== */
function show(id){
  document.querySelectorAll('.game').forEach(g=>g.style.display='none');
  document.getElementById(id).style.display='block';
}
function save(){
  localStorage.setItem('bal',balance);
  localStorage.setItem('xp',xp);
  localStorage.setItem('lvl',lvl);
  localStorage.setItem('fs',freeSpins);
  tg.sendData(JSON.stringify({balance,xp,lvl}));
}
function upd(){
  document.getElementById('balance').innerText = balance;
  document.getElementById('fs').innerText = freeSpins;
  document.getElementById('xp').innerText = xp;
  document.getElementById('lvl').innerText = lvl;
  save();
}
upd(); show('slots');

/* ===== XP ===== */
function addXP(v){
  xp+=v;
  if(xp>=lvl*100){ xp=0; lvl++; }
}

/* ===== SLOTS ===== */
const symbols = ["üçí","‚≠ê","üíé","üÉè","üéÅ"];
function spin(){
  if(freeSpins>0){ freeSpins--; }
  else if(balance<bet){ return; }
  else balance-=bet;

  let reels = document.getElementById('reels');
  reels.innerHTML = '';
  let grid=[[],[],[]];
  for(let r=0;r<3;r++){
    for(let c=0;c<5;c++){
      let s = symbols[Math.floor(Math.random()*symbols.length)];
      grid[r][c]=s;
    }
  }
  // render center line visually (fake 5x3 feel)
  for(let c=0;c<5;c++){
    let d=document.createElement('div');
    d.className='reel';
    d.innerText=grid[1][c];
    reels.appendChild(d);
  }
  // paylines: top, mid, bottom
  let lines=[[0],[1],[2]];
  let win=0, scat=0;
  ['l1','l2','l3'].forEach(id=>document.getElementById(id).classList.remove('on'));
  lines.forEach((lr,idx)=>{
    let row = grid[lr[0]];
    scat += row.filter(x=>x==="üéÅ").length;
    let uniq = new Set(row.filter(x=>x!=="üÉè"));
    if(uniq.size<=1){ win += bet*3; document.getElementById(['l1','l2','l3'][idx]).classList.add('on'); }
  });
  if(scat>=3){ freeSpins += 5; }
  if(win){
    balance+=win; addXP(10);
    slotRes.className = 'result bigwin';
    slotRes.innerText = `WIN +${win}` + (scat>=3?` ‚Ä¢ +5 FS`:'');
  }else{
    slotRes.className='result lose'; slotRes.innerText='Lose';
  }
  upd();
}

/* ===== CRASH ===== */
let cx=1, t=null, ing=false;
function startCrash(){
  if(balance<bet || ing) return;
  balance-=bet; ing=true; cx=1; upd();
  crashRes.innerText='';
  t=setInterval(()=>{
    // –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–π —Ä–æ—Å—Ç + —Ä–∞–Ω–Ω–∏–µ –∫—Ä–∞—à–∏
    cx += Math.random()*0.12*(1-cx/30);
    document.getElementById('crashVal').innerText=cx.toFixed(2)+'x';
    if(document.getElementById('auto').checked){
      let at = parseFloat(document.getElementById('autoAt').value||2);
      if(cx>=at) cashout();
    }
    if(Math.random()<0.012) boom();
  },100);
}
function cashout(){
  if(!ing) return;
  clearInterval(t); ing=false;
  let win=Math.floor(bet*cx);
  balance+=win; addXP(8);
  crashRes.className='result win'; crashRes.innerText=`WIN +${win}`;
  upd();
}
function boom(){
  clearInterval(t); ing=false;
  crashRes.className='result lose'; crashRes.innerText='CRASH';
}

/* ===== ROULETTE ===== */
const reds = new Set([1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36]);
function playRoulette(){
  if(balance<bet) return;
  balance-=bet;
  let n = Math.floor(Math.random()*37);
  let color = n===0?'green':(reds.has(n)?'red':'black');
  let win = color!=='green';
  if(win){ balance+=bet*2; addXP(5); }
  let h=document.getElementById('hist');
  let chip=document.createElement('div');
  chip.className='chip'; chip.innerText=n;
  h.prepend(chip); if(h.children.length>10) h.removeChild(h.lastChild);
  roulRes.className='result '+(win?'win':'lose');
  roulRes.innerText = win?`WIN ${n} ${color}`:`LOSE ${n}`;
  upd();
}

/* ===== MINES ===== */
let bombs=[], opened=0, coef=1;
function startMines(){
  if(balance<bet) return;
  balance-=bet; opened=0; coef=1; upd();
  bombs=[]; let k=+document.getElementById('bombsSel').value;
  while(bombs.length<k){
    let b=Math.floor(Math.random()*25);
    if(!bombs.includes(b)) bombs.push(b);
  }
  let g=document.getElementById('grid'); g.innerHTML='';
  for(let i=0;i<25;i++){
    let c=document.createElement('div');
    c.className='cell';
    c.onclick=()=>openCell(i,c);
    g.appendChild(c);
  }
  document.getElementById('coef').innerText=coef.toFixed(2)+'x';
  mineRes.innerText='';
}
function openCell(i,c){
  if(c.classList.contains('open')) return;
  c.classList.add('open');
  if(bombs.includes(i)){
    c.classList.add('dead'); c.innerText='üí£';
    mineRes.className='result lose'; mineRes.innerText='BOOM';
    document.querySelectorAll('.cell').forEach(x=>x.onclick=null);
  }else{
    c.innerText='üíé'; opened++;
    coef *= 1.18; document.getElementById('coef').innerText=coef.toFixed(2)+'x';
    mineRes.className='result win'; mineRes.innerText=`SAFE ‚Ä¢ ${coef.toFixed(2)}x`;
  }
}
function cashMines(){
  let win=Math.floor(bet*coef);
  balance+=win; addXP(12);
  mineRes.className='result win'; mineRes.innerText=`CASHOUT +${win}`;
  upd();
}

/* ===== BONUS ===== */
function daily(){
  let last = +localStorage.getItem('daily')||0;
  if(Date.now()-last<86400000){
    bonusRes.className='result lose'; bonusRes.innerText='Come back later';
    return;
  }
  let g=500;
  balance+=g; addXP(20);
  localStorage.setItem('daily',Date.now());
  bonusRes.className='result win'; bonusRes.innerText=`+${g}`;
  upd();
}
</script>
</body>
</html>
